---
title: functionçš„åŸå‹éˆ
slug: new-function
image: ./images/image-1.png
date: 2020-01-12
author: liyo
---

# ğŸš€ ğŸ§ ğŸ“ ğŸ’«javascript prototypeçš„ç­†è¨˜

## ğŸš€ åœ¨å‰›é–‹å§‹éœ€è¦å…·å‚™çš„çŸ¥è­˜
1. åœ¨javascriptä¸­, ä¸€åˆ‡çš„èµ·æºç‚ºObject, çµ•å¤§å¤šæ•¸ç‰©ä»¶éƒ½æ˜¯å¾Objectç¹¼æ‰¿ä¸Šå»çš„, ä¸éæˆ‘èªç‚ºä¸¦ä¸æ˜¯"Everything is an object", 
2. å¯¦ä¾‹å±¬æ€§(instance property)è·ŸåŸå‹å±¬æ€§
3. çŸ¥é“æœ‰åŸå‹éˆ(Prototype chain)å­˜åœ¨, ä¸¦çŸ¥é“å®ƒçš„çµ‚é»æ˜¯null
4. javascriptæ˜¯ä¸€ç¨®å‡½å¼èªè¨€(ç‰©ä»¶å°å‘OOJS)
5. **string, number, boolean, null, undefinedä¸æ˜¯object** ( é€™æˆ‘é‚„åœ¨æ‰¾è­‰æ˜ ), ä»–å€‘æ˜¯åŸå§‹å€¼( primitive value ), å³ä½¿ä½ å¯ä»¥è¨ªå•åˆ°å»ºæ§‹å™¨ç•¶åˆç¹¼æ‰¿çš„æ‰€æœ‰æ–¹æ³•, EX: å­—ä¸²æ˜¯åŸå§‹å€¼, ä½†é‚„æ˜¯å¯ä»¥è¨ªå•String.prototypeç¹¼æ‰¿çš„æ‰€æœ‰æ–¹æ³•

<div className="code">

```javascript

const numninja = "ninja";
console.log(numninja.__proto__) // åŸå§‹String
console.log(numninja.__proto__.__proto__) // ç”šè‡³å¯ä»¥çœ‹åˆ°æœ€åŸå§‹çš„Object
console.log(numninja.__proto__.__proto__.__proto__) // null åŸå‹éˆçµ‚é»
```

</div>

---

## ğŸ§ é¦–å…ˆè¢«ç•¶æˆèµ·æºçš„Objectäº”ç¨®ç‰¹æ€§, å‡¡æ˜¯ç›¸åŒè€…, çš†è¢«è¦–ä½œé ­ç­‰ç‰©ä»¶(è¢«ç•¶ç‰©ä»¶ä¾†è™•ç†, ä½†å¯¦éš›ä¸Šé‚„æ˜¯å¾Objectç¹¼æ‰¿ä¸Šå»çš„)

1. å¯ä»¥è—‰ç”±å¯¦å€¼ä¾†å»ºç«‹: 

<div className="code">

```javascript

{} // å»ºç«‹ä¸€å€‹object

```

</div>

2. å¯ä»¥è¢«æŒ‡æ´¾çµ¦è®Šæ•¸ã€é™£åˆ—è³‡æ–™é …æˆ–å…¶ä»–ç‰©ä»¶çš„å±¬æ€§:

<div className="code">

```javascript

let ninja = {}; // æŒ‡æ´¾çµ¦è®Šæ•¸
let ninjaArray.push({}); //æŒ‡æ´¾çµ¦é™£åˆ—è³‡æ–™é …
ninja.data = {}; //æŒ‡æ´¾çµ¦å…¶ä»–ç‰©ä»¶çš„å±¬æ€§

```

</div>

3. å¯ä»¥åšç‚ºå¼•æ•¸å‚³éçµ¦å‡½å¼:

<div className="code">

```javascript

function ninjaMove(ninja) {
 ninja.move = true;
}
ninjaMove({}) // æ–°å»ºç«‹çš„ç‰©ä»¶åšç‚ºå¼•æ•¸

```

</div>

4. å¯ä»¥åšç‚ºå‡½å¼çš„å›å‚³å€¼

<div className="code">

```javascript

function ninjaTalk() {
 return {}; // å›å‚³æ–°ç‰©ä»¶
}

```

</div>

5. æ“æœ‰å¯å‹•æ…‹å»ºç«‹å’ŒæŒ‡æ´¾çš„å±¬æ€§:

<div className="code">

```javascript

let ninja = {};
ninja.name = "unknown"; // æ–°å¢å±¬æ€§

```

</div>

---

## ğŸ§ é ­ç­‰ç‰©ä»¶-function, åœ¨javascriptä¸­æ“æœ‰ç‰©ä»¶çš„æ‰€æœ‰åŠŸèƒ½, å¹¾ä¹å’Œç‰©ä»¶æ˜¯ä¸€æ¨£çš„ 

<br/>

1. å¯ä»¥è—‰ç”±å¯¦å€¼ä¾†å»ºç«‹: 

<div className="code">

```javascript

function ninja() {}

```

</div>

2. å¯ä»¥è¢«æŒ‡æ´¾çµ¦è®Šæ•¸ã€é™£åˆ—è³‡æ–™é …æˆ–å…¶ä»–ç‰©ä»¶çš„å±¬æ€§:

<div className="code">

```javascript

let ninja = function() {}; // æŒ‡æ´¾çµ¦è®Šæ•¸
let ninjaArray.push(function() {}); //æŒ‡æ´¾çµ¦é™£åˆ—è³‡æ–™é …
ninja.data = function() {}; //æŒ‡æ´¾çµ¦å…¶ä»–ç‰©ä»¶çš„å±¬æ€§

```

</div>

3. å¯ä»¥åšç‚ºå¼•æ•¸å‚³éçµ¦å‡½å¼:

<div className="code">

```javascript

function ninjaMove(ninjaFunction) {
 ninjaFunction();
}
ninjaMove(function() {}) // æ–°å»ºç«‹çš„ç‰©ä»¶åšç‚ºå¼•æ•¸

```

</div>

4. å¯ä»¥åšç‚ºå‡½å¼çš„å›å‚³å€¼

<div className="code">

```javascript

function ninjaTalk() {
 return function() {}; // å›å‚³æ–°ç‰©ä»¶
}

```

</div>

5. æ“æœ‰å¯å‹•æ…‹å»ºç«‹å’ŒæŒ‡æ´¾çš„å±¬æ€§:

<div className="code">

```javascript

let ninja = function() {};
ninja.name = "unknown"; // æ–°å¢å±¬æ€§

```

</div>

---

### å…¶ä¸­åœ¨javascriptä¸­å®šç¾©å‡½å¼çš„æ–¹æ³•å¯ä»¥åˆ†ç‚ºå››å¤§é¡:

<br/>

1. declarationå’Œexpression

<div className="code">

```javascript

function ninja() {}; // å‡½å¼å®£å‘Š

let ninjaFunc = function() {}; // å‡½å¼è¡¨é”é€šå¸¸åšç‚ºå¼•æ•¸

```

</div>

2. ç®­é ­å‡½å¼(lambda)

<div className="code">

```javascript

let ninjaFunc = myArg => myArg*2; 

```

</div>

3. ç”Ÿæˆå™¨(generator)

<div className="code">

```javascript

function *ninjaFunc() {
 yield 'ninja';
} 

```

</div>

4. å‡½å¼å»ºæ§‹å¼ (new é‹ç®—å­)

<div className="code">

```javascript

function Ninja() {}; 

let ninja = new Ninja(); // æŒ‡æ´¾å»ºæ§‹å™¨

```

</div>

---
## ğŸ“ é—œæ–¼å‡½å¼é‹ç®—å­ new, newæœƒåš5ä»¶äº‹

<div className="code">

```javascript

function Ninja() {}; 

let ninja = new Ninja(); 

```

</div>

1. å‰µå»ºä¸€å€‹ç©ºç‰©ä»¶çµ¦ninja, ç´”ç²¹ç”¨å¯¦å€¼å»ºç«‹è€Œå·²

<div className="code">

```javascript

ninja = {}; 

```

</div>

2. å°‡ninja(é€™æ™‚æ˜¯ç©ºç‰©ä»¶)çš„[[Prototype]], ç€è¦½å™¨ä¸Šæœƒæ˜¯ \__proto\__ ,è¨­å®šç‚º Ninja.prototype, Ninja.prototypeä¸­åˆæœƒæœ‰ä»€éº¼??, åŒ…å«ä¸€äº›ç¶“ç”±Ninja.prototype.xxxè¨­å®šçš„**åŸå‹å±¬æ€§å’Œconstructorä»¥åŠ[[Prototype]]**

<div className="code">

```javascript

ninja.[[Prototype]] = Ninja.prototype 
// ç€è¦½å™¨ ninja.__proto__ = Ninja.prototype

```

</div>

* [[Prototype]]ç‚ºå°åŸå‹ç‰©ä»¶çš„éˆçµ
* æ¯ä¸€å€‹functionç‰©ä»¶éƒ½æœƒè‡ªå‹•åœ°å¸¶æœ‰prototypeé€™å€‹å±¬æ€§
* .prototypeä¸­çš„constructoræœƒæŒ‡å‘ç‰©ä»¶æœ¬èº«(Ninja), æŒ‡å‘å¯¦éš›ä¾†æº, ä¾ç…§ä¸Šè¿°çš„ä¾‹å­ä¾†èªª, ä»¥ä¸‹å››å€‹å…¶å¯¦æ˜¯ç›¸ç­‰çš„

<div className="code">

```javascript

function Ninja() {}; 

let ninja = new Ninja(); 

console.log(ninja.constructor); 
// é€™è£¡æœƒå»ä¸‹ä¸€å±¤([[Prototype]])æ‰¾constructor, åŸæœ¬çš„ninjaä¸¦æ²’æœ‰constructoré€™å±¬æ€§
console.log(Ninja)
console.log(ninja.__proto__.constructor);
console.log(Ninja.prototype.constructor)

```

</div>



3. å°‡æ‰¾åˆ°çš„constructorä¸­çš„thisæŒ‡å‘æ–°ç‰©ä»¶(ä¹Ÿå°±æ˜¯ninja)

<div className="code">

```javascript

function Ninja() {
 this.A = true; // é€™è£¡çš„thisåœ¨new Ninja()æ™‚æœƒæŒ‡å‘ninja
}; 

let ninja = new Ninja(); 

```

</div>

4. åŸ·è¡Œconstructorå‡½å¼, å°‡çˆ¶å…ƒä»¶å¯¦ä¾‹å±¬æ€§, åœ¨åŸå…ˆçš„ç©ºç‰©ä»¶åœ¨å»ºç«‹ä¸€æ¬¡

<div className="code">

```javascript

function Ninja() {
 this.A = true; // é€™è£¡çš„thisåœ¨new Ninja()æ™‚æœƒæŒ‡å‘ninja
}; 

let ninja = new Ninja();

// æº–å‚™ä¸€å€‹ ç©ºçš„{}
// {}.[[Prototype]]è¢«æŒ‡æ´¾
// åŸ·è¡Œ {}.[[Prototype]].constructor
// ç™¼ç¾ this.A = true, thisæœƒæŒ‡å‘{}
// å‰µå»º {}.A = true
// æº–å‚™å›å‚³è¨­å®šå®Œæˆçš„{}çµ¦ninja

```

</div>

5. åŸ·è¡Œå®Œconstructorå‡½å¼, å›å‚³è¨­å®šå®Œæˆçš„{}çµ¦ninja, é™¤éconstructor **å›å‚³é string, number, boolean, null, undefined**, è€Œæ˜¯å›å‚³ä¸€å€‹object( é™£åˆ—é‚£äº›ä¹Ÿç®—æ˜¯ )

* ä¹‹å‰ä¸Šé¢çš„functionéƒ½æ²’å¯«return , é è¨­éƒ½å›å‚³undefined, å› æ­¤éƒ½æ²’å•é¡Œ

<div className="code">

```javascript

function Ninja() {
 this.A = 1; 
 return { X: this.A + 10 }
};
Ninja.prototype.B = 5; 

let ninja = new Ninja(); 

console.log(ninja) // { X: 11 }
console.log(ninja.A) // undefined
console.log(ninja.B) // undefined, 
// å›å‚³çš„{ X: this.A + 10 }ä¸­çš„[[Prototype]]
// æŒ‡å‘çš„æ˜¯javascriptåŸç”ŸObjectä¸¦ä¸æ˜¯Ninja, æ‰€ä»¥åŸå‹éˆä¸­æ‰¾ä¸åˆ°B

```

</div>

<div className="code">

```javascript

function Ninja() {
 this.A = 1; 
 return function() { return true }
};
Ninja.prototype.B = 5; 

let ninja = new Ninja(); 

console.log(ninja) // Æ’ () {return true}
console.log(ninja.__proto__) // Æ’ () { [native code] } åŸå§‹ function
console.log(ninja.__proto__.__proto__) // åŸå§‹Object
console.log(ninja.__proto__.__proto__.__proto__) // çµ‚é»null
console.log(ninja.A) // undefined
console.log(ninja.B) // undefined, 
// å›å‚³çš„ Æ’ () {return true} ä¸­çš„[[Prototype]]
// æŒ‡å‘çš„æ˜¯javascriptåŸç”ŸFunctionä¸¦ä¸æ˜¯Ninja, æ‰€ä»¥åŸå‹éˆä¸­æ‰¾ä¸åˆ°B

```

</div>

<div className="code">

```javascript

function Ninja() {
 this.A = 1; 
 return new Number(100) // new å»ºæ§‹å­æœƒå›å‚³object
};
Ninja.prototype.B = 5; 

let ninja = new Ninja(); 

console.log(ninja) // Number { 100 }
console.log(ninja.__proto__) // åŸå§‹ Number
console.log(ninja.__proto__.__proto__) // åŸå§‹ Object
console.log(ninja.__proto__.__proto__.__proto__) // çµ‚é»null
console.log(ninja.A) // undefined
console.log(ninja.B) // undefined, 
// å›å‚³çš„ Number { 100 } ä¸­çš„[[Prototype]]
// æŒ‡å‘çš„æ˜¯javascriptåŸç”ŸNumberä¸¦ä¸æ˜¯Ninja, æ‰€ä»¥åŸå‹éˆä¸­æ‰¾ä¸åˆ°B

```

</div>

---
